import matplotlib.pyplot as plt
from scipy.stats import ttest_1samp, ttest_ind
import seaborn as sns
import numpy as np

not_self_reg = [0.30071709896931414, 0.2227433687848726, 0.22309531983510705, 0.16541231073078688, 0.04797209450252254, 0.5231732945341424, 0.07590555881891096, 0.2694571607903621, 0.021727589580354163, -0.2586785714598658, -0.19826546262363004, -0.02233366977139505, 0.09847635864874849, 0.23676812516756318, 0.18795836871080585, 0.107488620911397, 0.18524822887961737, 0.20683611223483536, -0.04742903766949839, 0.019960860979961866, 0.30530503235711964, 0.3010708353177063, 0.2396392875490737, 0.27342328183987336, 0.2509888882345453, 0.28822570299872985, 0.10442890035272984, 0.2267801121175574, 0.25486543421380836, -0.021349486576576048, -0.39750835663709216, -0.033008590382018116, 0.036007044056303075, 0.36550155763434333, -0.07607192882740775, 0.21276767219121973, 0.02328521157757688, -0.19882396452986845]

self_reg = [0.04933636042744077, 0.08940443822185712, 0.39290252677500603, 0.17710328335436412, 0.055389678891741644, -0.49628722570241923, 0.08180351899426345, 0.30902094505897076, 0.509889341791496, 0.1328077581370403, 0.29764545615833266, 0.38995680502603236, 0.3054716702584317, 0.33241804192144164, 0.26831028087445025, 0.35246566037119187, 0.37587646989387674, 0.22988445054644302, -0.31290132153776057, 0.102847267669314, 0.1822127505836216, 0.1808072015371219, -0.007060457653250366, 0.018361589746986835]

normal =[0.18795836871080585, 0.30530503235711964, 0.02328521157757688, 0.04933636042744077, -0.19882396452986845, 0.04797209450252254, 0.07590555881891096, 0.1808072015371219, 0.17710328335436412, 0.021727589580354163, 0.1328077581370403, 0.018361589746986835, 0.2227433687848726, 0.25486543421380836, 0.33241804192144164, 0.08180351899426345, 0.26831028087445025, -0.19826546262363004, 0.27342328183987336, 0.2267801121175574, 0.16541231073078688, 0.39290252677500603, -0.033008590382018116, 0.21276767219121973, 0.35246566037119187, 0.5231732945341424, 0.3054716702584317, 0.30071709896931414, -0.02233366977139505, 0.036007044056303075, 0.30902094505897076, 0.29764545615833266, 0.18524822887961737, 0.1822127505836216, 0.102847267669314, 0.37587646989387674, 0.2694571607903621, 0.2396392875490737, 0.22309531983510705, 0.22988445054644302, 0.2509888882345453, -0.021349486576576048, -0.39750835663709216, 0.36550155763434333, 0.055389678891741644, 0.09847635864874849, 0.10442890035272984, -0.007060457653250366, 0.3010708353177063, -0.2586785714598658, 0.509889341791496, 0.107488620911397, -0.07607192882740775, 0.28822570299872985, 0.23676812516756318, 0.38995680502603236, -0.31290132153776057, 0.019960860979961866, -0.49628722570241923, 0.08940443822185712, 0.20683611223483536, -0.04742903766949839] 

stat, pval = ttest_ind(normal,self_reg)
print("all, self reg", pval)
stat, pval_r = ttest_ind(normal,not_self_reg)
print("all, not self reg", pval_r)
stat, pval_r = ttest_ind(self_reg,not_self_reg)
print("self reg, not self reg", pval_r)

fig, ax = plt.subplots()
ax.boxplot([normal,self_reg,not_self_reg])
#sns.swarmplot(data=[normal_corr,row_random_corr,col_random_corr,col_row_random])
labels = ["All TFs","Self-Regulated TFs","Non-Self-Regulated TFs"]
ax.set_title("RNA Seq TF Eval Correlation Distribution DoRothEA Self Regulation Test")
ax.set_ylabel("Correlation")
ax.set_xlabel("")
ax.set_xticks(np.arange(1, len(labels) + 1))
ax.set_xticklabels(labels)

fig.savefig("dorothea_self_reg.png")

