
library(ggplot2)
library(dplyr)

Here is how to retrieve all regulons from human:

net <- decoupleR::get_dorothea(levels = c('A', 'B', 'C', 'D'))
head(net)
#> # A tibble: 6 × 4
#>   source confidence target   mor
#>   <chr>  <chr>      <chr>  <dbl>
#> 1 MYC    A          TERT    1   
#> 2 JUN    D          SMAD3   0.25
#> 3 SMAD3  A          JUN     1   
#> 4 JUN    D          SMAD4   0.25
#> 5 SMAD4  A          JUN     1   
#> 6 RELA   D          FAS     0.25

Here we can observe some of the target genes for the TF ADNP. We can see their confidence level, in this case D, and their mode of regulation, in this case positive. To better estimate TF activities, we recommend to select regulons from the confidence levels A, B and C.
Exploration

We can observe the total number of genes per TF:

n_genes <- net %>%
  group_by(source) %>%
  summarize(n = n())

ggplot(data=n_genes, aes(x=n)) +
  geom_density() +
  theme(text = element_text(size=12)) +
  xlab('Number of target genes') +
  ylab('densities') +
  theme_bw() +
  theme(legend.position = "none")

The majority of TFs have around 20 target genes, but there are some that reach more than 1000.

Additionally, we can visualize how many edges each confidence level adds:

n_edges <- net %>%
  group_by(confidence) %>%
  summarize(n = n())

ggplot(data=n_edges, aes(x=confidence, y=log10(n), color=confidence, fill=confidence)) +
  geom_bar(stat="identity") +
  theme(text = element_text(size=12)) +
  xlab('Confidence') +
  ylab('log10(Number of edges)') +
  theme_bw() +
  theme(legend.position = "none")

Each confidence level contributes around 10,000 TF - target relationships, B and E being the exceptions.

We can also check how many TFs are repressors, TFs with most of their edges with negative mode of regulation (mor), and how many are activators, TFs with most of their edges with positive mor:

prop <- net %>%
  mutate(mor = case_when(mor < 0 ~ -1, mor > 0 ~ 1)) %>%
  group_by(source, mor) %>%
  summarize(n = n()) %>%
  mutate(freq = n / sum(n)) %>%
  filter(mor == 1)
#> `summarise()` has grouped output by 'source'. You can override using the
#> `.groups` argument.

ggplot(data=prop, aes(x=freq)) +
  geom_density() +
  theme(text = element_text(size=12)) +
  xlab('% of positive edges') +
  ylab('densities') +
  theme_bw() +
  theme(legend.position = "none")

Most TFs in DoRothEA are activators, but there are also some of them that are repressors.
CollecTRI

Recently, we have released a new literature based GRN with increased coverage and better performance at identifying perturbed TFs, called CollecTRI. We encourage users to use CollecTRI instead of DoRothEA. Vignettes on how to obtain activities are available at the decoupleR package.

Here’s how to access it. The argument split_complexes keeps complexes or splits them into subunits, by default we recommend to keep complexes together.

net <- decoupleR::get_collectri(split_complexes = FALSE)
head(net)
#> # A tibble: 6 × 3
#>   source target   mor
#>   <chr>  <chr>  <dbl>
#> 1 MYC    TERT       1
#> 2 SPI1   BGLAP      1
#> 3 SMAD3  ADAM2      1
#> 4 SMAD3  JUN        1
#> 5 SMAD4  ADAM2      1
#> 6 SMAD4  JUN        1

We can observe the total number of genes per TF:

n_genes <- net %>%
  group_by(source) %>%
  summarize(n = n())

ggplot(data=n_genes, aes(x=n)) +
  geom_density() +
  theme(text = element_text(size=12)) +
  xlab('Number of target genes') +
  ylab('densities') +
  theme_bw() +
  theme(legend.position = "none")

Similarly to DoRothEA, the majority of TFsin CollecTRI have around 20 target genes, but there are some that reach more than 1000.

We can also check how many TFs are repressors, TFs with most of their edges with negative mode of regulation (mor), and how many are activators, TFs with most of their edges with positive mor:

prop <- net %>%
  mutate(mor = case_when(mor < 0 ~ -1, mor > 0 ~ 1)) %>%
  group_by(source, mor) %>%
  summarize(n = n()) %>%
  mutate(freq = n / sum(n)) %>%
  filter(mor == 1)
#> `summarise()` has grouped output by 'source'. You can override using the
#> `.groups` argument.

ggplot(data=prop, aes(x=freq)) +
  geom_density() +
  theme(text = element_text(size=12)) +
  xlab('% of positive edges') +
  ylab('densities') +
  theme_bw() +
  theme(legend.position = "none")

As seen in DoRothEA, Most TFs in CollecTRI are also activators.
Contents

    Introduction
    Activity estimation
    Load
    Exploration
    CollecTRI 

Developed by Pau Badia-i-Mompel, Daniel Dimitrov, Christian H. Holland, Luz Garcia-Alonso.

Site built with pkgdown 2.0.7.

library(dorothea)
library(decoupleR)
net <- decoupleR::get_dorothea(levels = c('C', 'D'))
write.table(net,'pknCD.csv',sep='\t',row.names=FALSE,quote=FALSE)
net <- decoupleR::get_dorothea(levels = c('A','B'))
write.table(net,'pknAB.csv',sep='\t',row.names=FALSE,quote=FALSE)
