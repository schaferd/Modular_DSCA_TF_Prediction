import pandas as pd
from scipy.stats import ttest_1samp, ttest_ind
import matplotlib.pyplot as plt 
import seaborn as sns
import numpy as np

rel0AB = [0.6263288602300453,0.6058731265249215,0.6657776477617886,0.607619006124583,0.6683513419309863,0.6465698600806653,0.6334213015983668,0.633072748095404,0.6979877259373599]
rel0_constAB =0.4908890581569005

rel2AB = [0.568753519470244,0.6760839968351497,0.6224668724294502,0.6206420939333244,0.6263160145697158,0.6189313640932063,0.6385905011725628,0.5644161065214447,0.6498884461583423]
rel2_constAB = 0.46754409151279364

rel4AB = [0.6583555937459138,0.6954448657837222,0.6201361776847926,0.6929137167728318,0.6440746829058712,0.6214297722899894,0.6576270711523733,0.6240916817663871,0.6473110044271758]
rel4AB_const =0.46211924225590856

rel6AB = [0.6588120413477472,0.7047906967568847,0.6598181172571609,0.6981722954312317,0.5912175491201768,0.7157835555906258,0.6833671979799574,0.6259962124201056,0.6884320997396038]
rel6AB_const = 0.4230703413714717

rel8AB = [0.6565838712959717,0.6425365456580479,0.6570417519304474,0.6381838532068603,0.6662106703146374,0.6368441283874688,0.7080247820827351,0.6546619032006421,0.660670879922217]
rel8AB_const = 0.43326572592679363 

rel10AB = [0.6981549106284836,0.6461656736498174,0.6400266814394411,0.6704729172083979,0.6097217668539643,0.6357022532249494,0.6420730121762332,0.6809306847859268,0.6503487806808289]
rel10AB_const = 0.4446827520610833

rel12AB = [0.6470250035135238,0.6709105776233247,0.6431792919291163,0.7183112087799768,0.6356220214899896,0.6006145472664784,0.6779376253689201,0.6660235853275243,0.6740663608836194]
rel12AB_const =0.371282650521324

rel14AB = [0.6124465361561221,0.6953442381689688,0.6606444788520794,0.6822906286888136,0.6975134521929758,0.6766108138768377,0.6802287256059236,0.6752464319112079,0.6651208781101009]
rel14AB_const = 0.4292562012550817 

rel16AB = [0.6340865732517598,0.6763288599434248,0.675745016775212,0.6323597131767646,0.6511002565620683,0.6938194855601604,0.7117623840536806,0.6503930662456416,0.670687783698441]
rel16AB_const = 0.4725603434723572



rel0A = [0.663204484930223, 0.6716565896700308, 0.607002845941961, 0.652229321202839, 0.6579440640965563, 0.6650617763706811, 0.6796658018355755, 0.6576811859234453, 0.6322991553610003]
rel0A_const = 0.6237558388931204

rel2A = [0.6291157934855105, 0.63697306273565, 0.6632944042903617, 0.6425946343256156, 0.673543904065771, 0.6640430397321246, 0.6731525719030313, 0.6764261505165585, 0.6326309771734249]
rel2A_const = 0.5687448331615635

rel4A = [0.6606579119421665,0.6856425008873032,0.6815422262903256,0.6426223077354155,0.6789176769469298,0.6793659985429548,0.6819531877533485,0.664323874992995,0.6649403171875292]
rel4A_const = 0.5751945098236579

rel6A = [0.7117230493579624, 0.6834552706795785, 0.6563659826799199, 0.6701132630860458, 0.629223369310183, 0.647551299006015, 0.6609039716735634, 0.7270380956443838, 0.6820101531504629]
rel6A_const = 0.5463530510834217

rel8A = [0.6739699438284857, 0.6822192159515336, 0.719973237655501, 0.6962400376437372, 0.6997911948945682, 0.6894538717172014, 0.6638678940093522, 0.6595373937593743, 0.6952180689939123]
rel8A_const = 0.5080575775739203

rel10A = [0.6892700644060819, 0.7301488103990824, 0.6893582919154192, 0.709577096138576, 0.6829617974884569, 0.6641619857071435, 0.6727127018204276, 0.6615298650119107, 0.6604490780225274]
rel10A_const = 0.5040434168227801

rel12A = [0.648337112622827, 0.6318263416477702, 0.7029635928445451, 0.7044359410430838, 0.627905328798186, 0.6827995086923657, 0.6581553917863441, 0.6702884857646763, 0.6353064373897708]
rel12A_const = 0.4828911885664833

rel14A = [0.7421520576798444,0.7021731205443941,0.7163196694750485,0.6989326798444588,0.6448679520414776,0.6585790667530784,0.6509944102397927,0.7326636422553469,0.688077203499676]
rel14A_const = 0.47465783768760106

rel16A = [0.6875388291517324,0.7290322580645162,0.5728315412186381,0.6863321385902031,0.6847192353643966,0.7446833930704899,0.7207407407407407,0.69194743130227,0.6805734767025088]
rel16A_const = 0.47498647565671975


rel0ABC = [0.5082602637433699,0.582845133526817,0.5225944772477078,0.5448040400618942,0.5835341303628203,0.5675832762376923,0.47414144835603045,0.5246306746010362,0.5585108430395923]
rel0ABC_const = 0.363438011763811

rel2ABC = [0.5160962643420981,0.500026849481805,0.551170637406698,0.5174029391232748,0.5446954373780586,0.5334141801063239,0.5867462007983246,0.5229160327205685,0.5346403064420857]
rel2ABC_const = 0.42101337834238733

rel4ABC = [0.5120408256566165,0.5446773493039523,0.5357681669600202,0.5707248497039797,0.5381797608978902,0.5953893981301575,0.5576210940178755,0.567136032185064,0.548100441173109]
rel4ABC_const = 0.42550566483642455

rel6ABC = [0.5502205865545067,0.5720277961917388,0.5450830914119825,0.5646558621162594,0.5202642466912017,0.6163051180652388,0.4791700002285871,0.5795654559169772,0.5842514915308478]
rel6ABC_const = 0.36232428996148375

rel8ABC = [0.5361599422734794,0.5349469388770698,0.5473942198833028,0.5399171425372299,0.5562024907003073,0.5481966682840045,0.5301011458216698,0.638674280595678,0.5386730364896304]
rel8ABC_const = 0.4025872680768545

rel10ABC = [0.5757349556476195,0.5509834658306274,0.5740616330135981,0.50012441060476,0.5323032135259209,0.5286082185645504,0.5393510742855722,0.5442030878712101,0.5303748491521418]
rel10ABC_const = 0.3969604835367357

rel12ABC = [0.540268323047175,0.5131777607077583,0.541619209069478,0.5126744894445475,0.5386525574126559,0.527044208407279,0.5414867692633698,0.5521018197229359,0.5681733901941567]
rel12ABC_const = 0.46875607033594824

rel14ABC = [0.5554856567689985,0.47580324742404584,0.5868937567875401,0.5283818504489709,0.5128267952215717,0.49635790533202656,0.5772322729319523,0.5217002622308161,0.4733001350886023]
rel14ABC_const = 0.4256579320991884 

rel16ABC = [0.5835960056154478, 0.5771925409901201, 0.5631804095038805, 0.5455063173787513, 0.520932111355389, 0.5501152226313141, 0.5665178926178052, 0.5877413715466321, 0.5189124043122401]
rel16ABC_const = 0.4154656825632815

"""
gradeA = np.array([rel0A, rel2A,rel4A, rel6A, rel8A, rel10A, rel12A, rel14A, rel16A])
gradeAB = np.array([rel0AB, rel2AB,rel4AB, rel6AB, rel8AB, rel10AB, rel12AB, rel14AB, rel16AB])
gradeABC = np.array([rel0ABC, rel2ABC,rel4ABC, rel6ABC, rel8ABC, rel10ABC, rel12ABC, rel14ABC, rel16ABC])

dfA = pd.DataFrame(gradeA, columns= ['rel0','rel2','rel4','rel6','rel8','rel10','rel12','rel14','rel16'])
dfA = dfA.melt(value_vars=['rel0','rel2','rel4','rel6','rel8','rel10','rel12','rel14','rel16'],value_name='A',var_name='relationship cutoff')
print(dfA)

dfAB = pd.DataFrame(gradeAB, columns= ['rel0','rel2','rel4','rel6','rel8','rel10','rel12','rel14','rel16'])
dfAB = dfAB.melt(value_vars=['rel0','rel2','rel4','rel6','rel8','rel10','rel12','rel14','rel16'],value_name='AB',var_name='relationship cutoff ab')

dfABC = pd.DataFrame(gradeABC, columns= ['rel0','rel2','rel4','rel6','rel8','rel10','rel12','rel14','rel16'])
dfABC = dfABC.melt(value_vars=['rel0','rel2','rel4','rel6','rel8','rel10','rel12','rel14','rel16'],value_name='ABC',var_name='relationship cutoff abc')

df = pd.concat([dfA,dfAB,dfABC],axis=1)
df = df.drop(columns = ['relationship cutoff ab','relationship cutoff abc'])
df = df.melt(id_vars=['relationship cutoff'],value_vars=['A',"AB","ABC"],var_name='grade')
print(df)

fig,ax = plt.subplots()
sns.boxplot(x='relationship cutoff',y='value',data=df,hue='grade',ax=ax)
ax.set_ylim(0.3, 0.8)
plt.ylabel('KO ROC AUC')
plt.savefig('relationships_roc_auc.png')
"""


rels = ['rel0','rel8','rel16']

gradeA = [rel0A,  rel8A,  rel16A]
gradeAB = [rel0AB,  rel8AB,  rel16AB]
gradeABC = [rel0ABC, rel8ABC, rel16ABC]

gradeA = {rels[i]:gradeA[i] for i in range(len(gradeA))}
gradeAB = {rels[i]:gradeAB[i] for i in range(len(gradeAB))}
gradeABC = {rels[i]:gradeABC[i] for i in range(len(gradeABC))}

print(gradeA)

dfA = pd.DataFrame(gradeA)
dfA = dfA.melt(value_vars=rels,value_name='A',var_name='relationship cutoff')
print(dfA)

dfAB = pd.DataFrame(gradeAB)
dfAB = dfAB.melt(value_vars=rels,value_name='AB',var_name='relationship cutoff ab')

dfABC = pd.DataFrame(gradeABC)
dfABC = dfABC.melt(value_vars=rels,value_name='ABC',var_name='relationship cutoff abc')

df = pd.concat([dfA,dfAB,dfABC],axis=1)
df = df.drop(columns = ['relationship cutoff ab','relationship cutoff abc'])
print(df)
df = df.melt(id_vars=['relationship cutoff'],value_vars=['A',"AB","ABC"],var_name='grade')
print(df)

fig,ax = plt.subplots()
sns.boxplot(x='relationship cutoff',y='value',data=df,hue='grade',ax=ax)
ax.set_ylim(0.3, 0.8)
plt.ylabel('KO ROC AUC')
plt.savefig('relationships_roc_auc2.png')



stat, pval_r = ttest_ind(rel0A,rel8A)
print("rel0 A,rel8 A",pval_r)
stat, pval_r = ttest_ind(rel8A,rel16A)
print("rel8 A,rel16 A",pval_r)

stat, pval_r = ttest_ind(rel0AB,rel8AB)
print("rel0 AB,rel8 AB",pval_r)
stat, pval_r = ttest_ind(rel8AB,rel16AB)
print("rel8 AB,rel16 AB",pval_r)
